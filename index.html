<!doctype html>
<html lang='ar' dir='rtl'><head>
<meta charset='utf-8'/><meta name='viewport' content='width=device-width,initial-scale=1'/>
<title>توليد تقارير السيارات (PDF) — Encar</title>
<style>
:root{--card:#111827;--bg:#0b1220;--muted:#9ca3af;--accent:#2563eb}
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);color:#e5e7eb;margin:0;padding:24px}
.wrap{max-width:880px;margin:0 auto}.card{background:var(--card);border:1px solid #1f2937;border-radius:16px;padding:20px}
h1{font-size:22px;margin:0 0 12px}textarea{width:100%;min-height:180px;border-radius:10px;border:1px solid #374151;background:#0f172a;color:#e5e7eb;padding:12px;font-size:14px}
.row{display:flex;gap:12px;flex-wrap:wrap;margin:12px 0}button{background:var(--accent);color:white;border:0;padding:10px 16px;border-radius:10px;font-size:15px;cursor:pointer}
button[disabled]{opacity:.6;cursor:not-allowed}.muted{color:var(--muted);font-size:13px}.footer{margin-top:16px;font-size:12px;color:#94a3b8}
input[type=text]{flex:1;min-width:200px;border-radius:10px;border:1px solid #374151;background:#0f172a;color:#e5e7eb;padding:10px 12px}
</style></head><body><div class='wrap'><div class='card'>
<h1>توليد تقارير السيارات (PDF) — Encar</h1>
<p class='muted'>ألصق <b>أرقام السيارات</b> (ID) — كل رقم في سطر — أو الروابط الكاملة <code>https://fem.encar.com/cars/detail/…</code></p>
<textarea id='ids' placeholder='مثال:
39509415
141013945'></textarea>
<div class='row'><input type='text' id='api' placeholder='رابط الـAPI (اتركه فارغًا إذا كانت الواجهة على نفس الخادم)'/><button id='run'>توليد وتحميل ZIP</button></div>
<div id='msg' class='muted'></div><div class='footer'>تلميح: يمكنك فتح هذه الصفحة من جوالك، ولصق الأرقام مباشرة ثم الضغط على زر التحميل.</div>
</div></div>
<script>
const btn=document.getElementById('run'),idsEl=document.getElementById('ids'),apiEl=document.getElementById('api'),msg=document.getElementById('msg');
function dl(b,n){const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download=n;a.click();URL.revokeObjectURL(u)}
btn.onclick=async()=>{const raw=idsEl.value.trim();if(!raw){alert('أدخل IDs أولًا');return}const ids=raw.split(/\s+/).filter(Boolean);
const base=(apiEl.value.trim()||location.origin).replace(/\/$/,'');const url=base+'/make-pdfs';btn.disabled=true;msg.textContent='يتم التحضير...';
try{const res=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({ids})});if(!res.ok)throw new Error('HTTP '+res.status);
const blob=await res.blob();dl(blob,'encar_pdfs.zip');msg.innerHTML='<span style="color:#34d399">تم التحميل ✅</span>'}catch(e){msg.innerHTML='<span style="color:#f87171">خطأ: '+e.message+'</span>'}
finally{btn.disabled=false}};
</script></body></html>